#!/bin/sh

. /home/engines/functions/checks.sh\r\n\r\n. /home/engines/scripts/engine/dns_functions.sh\r\n\r\n#. /home/engines/functions/params_to_env.sh\r\n#params_to_env\r\n\r\n\r\n  if test \"$type_path\" = \"domains\"\r\n   then        \r\n     if test $wan_or_lan = lan\r\n        then\r\n          ip=`cat /home/engines/system/net/ip`\r\n      elif test  $wan_or_lan = wan\r\n         then\r\n           ip=`cat /home/engines/system/net/public`\r\n      fi\r\n    touch /home/bind/domain_list/${wan_or_lan}/${domain_name}   \r\n    cat /home/engines/templates/dns/config_file_zone_entry.tmpl | sed \" /DOMAIN/s//${domain_name}/g\" > /home/bind/engines/domains/${domain_name}\r\n    cat /home/engines/templates/dns/selfhosted.tmpl | sed \"/DOMAIN/s//${domain_name}/g\"\\\r\n         | sed \"/IP/s//${ip}/g\" > /home/bind/engines/zones/named.conf.${domain_name}\r\n    cat /home/bind/engines/domains/* > /home/bind/engines/domains.hosted\r\n    kill -HUP `cat /home/engines/run/named.pid`\r\n    echo Success\r\n    exit 0\r\n  fi\r\nif test \"$ip\" = false\r\n then\r\n  echo \"No IP\"\r\n  exit 1\r\nfi   \r\n\r\ndomain_name=engines.internal\r\nadd_to_internal_domain\r\n\r\necho Success\r\nexit $
